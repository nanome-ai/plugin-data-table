import{o as M,r as b,a as u,c as v,b as p,F as h,d as x,e as d,w as A,f as $,g as O,h as D,i as B,u as f,s as C,t as W,j as N,k as P,l as q,m as H,n as J,p as z,q as G,v as K,x as Q,y as X,z as Y,A as Z,B as ee,C as te,D as oe,E as se,G as ne,P as le,T as ae}from"./vendor.fb735e21.js";const re=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function l(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function r(e){if(e.ep)return;e.ep=!0;const t=l(e);fetch(e.href,t)}};re();const ce={setup(g){return M(()=>{document.body.addEventListener("click",s=>{document.body.classList.add("using-mouse"),s.target.tagName==="BUTTON"&&s.target.blur()}),document.body.addEventListener("keydown",s=>{s.keyCode===9&&document.body.classList.remove("using-mouse")})}),(s,l)=>{const r=b("router-view"),e=b("Toast");return u(),v(h,null,[p(r),p(e)],64)}}},ie={class:"h-full flex align-items-center justify-content-center"},ue={class:"surface-card w-20rem p-4 shadow-sm border-round"},de=d("div",{class:"mb-2"},"Enter an ID to connect:",-1),me=O("Connect"),pe={setup(g){const s=x("");return(l,r)=>{const e=b("InputText"),t=b("Button");return u(),v("div",ie,[d("div",ue,[d("form",{class:"flex flex-column",onSubmit:r[1]||(r[1]=A(a=>l.$router.push(`/${s.value}`),["prevent"]))},[de,p(e,{modelValue:s.value,"onUpdate:modelValue":r[0]||(r[0]=a=>s.value=a),class:"mb-2",type:"text"},null,8,["modelValue"]),p(t,{class:"text-center",type:"submit"},{default:$(()=>[me]),_:1})],32)])])}}};function L(g,s,l="modelValue"){return D({get:()=>g[l],set:r=>s(`update:${l}`,r)})}const fe={class:"mt-2 max-w-full max-h-full overflow-x-scroll"},ve={key:1,class:"h-4rem inline-flex align-items-center"},xe=d("i",{class:"pi pi-exclamation-triangle text-500 text-5xl"},null,-1),_e=[xe],ge={props:{columns:Array,complexIndex:Number,images:Object,modelValue:Array,selectedFrame:Object},emits:["update:modelValue","update:selectedFrame"],setup(g,{emit:s}){const l=g,r=L(l,s),e=L(l,s,"selectedFrame"),t=x([...l.columns]),a=x(null);B(()=>l.columns,()=>{t.value=[...l.columns],r.value.forEach(i=>{Object.entries(i).forEach(([c,y])=>{if(y.length>30){const o=t.value.indexOf(c);o!==-1&&t.value.splice(o,1)}})})},{immediate:!0});const w=i=>{const c=l.complexIndex+"-"+i;return l.images[c]},V=(...i)=>{console.log("onColumnReorder",...i)},S=i=>{a.value=null,r.value=i.value};return(i,c)=>{const y=b("MultiSelect");return u(),v(h,null,[p(y,{modelValue:t.value,"onUpdate:modelValue":c[0]||(c[0]=o=>t.value=o),options:l.columns,"max-selected-labels":.1,class:"mx-2",placeholder:"toggle columns","selected-items-label":"toggle columns"},null,8,["modelValue","options","max-selected-labels"]),d("div",fe,[p(f(J),{selection:f(e),"onUpdate:selection":c[1]||(c[1]=o=>H(e)?e.value=o:null),sortField:a.value,"onUpdate:sortField":c[2]||(c[2]=o=>a.value=o),loading:!f(r).length,value:f(r),"selection-mode":"single","reorderable-columns":"","removable-sort":"",onColumnReorder:V,onRowReorder:S},{default:$(()=>[p(f(C),{"reorderable-column":!1,"header-class":"w-3rem","row-reorder":""}),p(f(C),{field:"index",header:"Index","body-class":"text-center",sortable:""},{body:$(({data:o})=>[O(W(o.index+1),1)]),_:1}),p(f(C),{field:"image",header:"Image","body-class":"py-0 text-center"},{body:$(({data:o})=>[w(o.index)?(u(),N(f(P),{key:0,src:`data:image/png;base64,${w(o.index)}`,"image-class":"h-4rem",preview:""},null,8,["src"])):(u(),v("div",ve,_e))]),_:1}),(u(!0),v(h,null,q(l.columns.filter(o=>t.value.includes(o)),o=>(u(),N(f(C),{key:o,field:o,header:o,"body-class":"text-center",sortable:""},null,8,["field","header"]))),128))]),_:1},8,["selection","sortField","loading","value"])])],64)}}},ye={class:"h-full p-4 flex align-items-center justify-content-center"},be={class:"surface-card max-w-full max-h-full min-w-2 p-4 shadow-2 border-round text-center overflow-y-auto"},he=d("div",null,"Disconnected",-1),we=d("div",{class:"py-4"},[d("i",{class:"pi pi-times-circle text-6xl"})],-1),ke=O("Reconnect"),$e=d("div",null,"Connecting...",-1),Ve=d("div",{class:"py-4"},[d("i",{class:"pi pi-spin pi-spinner text-6xl"})],-1),Se={props:{id:String},setup(g){const s=g,l=z(),r=G();let e=null;const t=x("offline"),a=x([]),w=K({}),V=x([]),S=x([]),i=x(null),c=x(null);B(a,()=>{const m=new Set([].concat(...a.value.map(n=>Object.keys(n))));m.delete("index"),V.value=Array.from(m)});const y=(m,n)=>{e.send(JSON.stringify({type:m,data:n}))},o=()=>{y("join",s.id),t.value="online"},R=m=>{const n=JSON.parse(m.data);switch(n.type){case"complexes":S.value=n.data;break;case"data":a.value=n.data;break;case"image":w[n.data.id]=n.data.data;break;case"select-complex":i.value=n.data;break;case"select-frame":c.value=a.value.find(F=>F.index===n.data);break;case"close":e.close();break;case"error":l.add({severity:"error",summary:"Error",detail:n.data,life:5e3}),r.push("/");break;default:console.error("Unknown message",n)}},I=()=>{t.value="offline",e=null,a.value=[],c.value=null},T=()=>{e||(e=new WebSocket(`ws://${location.hostname}/ws`),t.value="connecting",e.onopen=o,e.onmessage=R,e.onclose=I)},j=m=>{a.value=[],c.value=null,y("select-complex",m.value)},E=m=>{y("select-frame",m.index)};return T(),(m,n)=>{const F=b("Button"),U=b("Dropdown");return u(),v("div",ye,[d("div",be,[t.value==="offline"?(u(),v(h,{key:0},[he,we,p(F,{onClick:T},{default:$(()=>[ke]),_:1})],64)):t.value==="connecting"?(u(),v(h,{key:1},[$e,Ve],64)):(u(),v(h,{key:2},[p(U,{modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=k=>i.value=k),options:S.value,class:"mx-2",optionLabel:"name",optionValue:"index",placeholder:"Select a complex",onChange:j},null,8,["modelValue","options"]),i.value?(u(),N(ge,{key:0,columns:V.value,"complex-index":i.value,images:f(w),modelValue:a.value,"onUpdate:modelValue":n[1]||(n[1]=k=>a.value=k),selectedFrame:c.value,"onUpdate:selectedFrame":[n[2]||(n[2]=k=>c.value=k),E]},null,8,["columns","complex-index","images","modelValue","selectedFrame"])):Q("",!0)],64))])])}}},Ce=[{path:"/",name:"Home",component:pe},{path:"/:id",name:"Session",component:Se,props:!0}],Fe=X({history:Y(),routes:Ce});const _=Z(ce);_.component("Button",ee);_.component("Dropdown",te);_.component("InputText",oe);_.component("MultiSelect",se);_.component("Toast",ne);_.use(le,{ripple:!0,inputStyle:"filled"});_.use(ae);_.use(Fe);_.mount("#app");
